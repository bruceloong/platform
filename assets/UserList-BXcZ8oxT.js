import{u as S,r as o,j as e,B as n,T as d,L as c}from"./index-DNKwSigP.js";import{g as k,a as C}from"./auth-Dnu7h_Ld.js";import{C as T,R as w}from"./index-ju4Agrhi.js";import{I as v}from"./index-BEW0C3a_.js";import{R as z}from"./SearchOutlined-BoZBueDv.js";import{F as E}from"./Table-CviPWcWE.js";import{T as P}from"./index-BCiuEYGv.js";import{S as U}from"./index-DJwFW-wy.js";import{R as $}from"./EditOutlined-bkcECOvK.js";import{P as B}from"./index-BtojJBxz.js";import{R as D}from"./DeleteOutlined-C_9fO5J1.js";import"./EllipsisOutlined-BvIdc74o.js";import"./roundedArrow-lmzeC9YX.js";import"./useVariants-DGRfSi4p.js";import"./index-5mpMU4X_.js";import"./TextArea-BLZ2eM8T.js";import"./styleChecker-BtChOqs9.js";import"./index-C4_E_p9z.js";import"./PurePanel-CuWGgxen.js";import"./useIcons-B87gjmAx.js";import"./DownOutlined-DHwEt_XM.js";import"./index-CDSZdq6m.js";import"./useBubbleLock-Km5IXhiq.js";import"./index-CwPdWqEn.js";import"./LeftOutlined-e1Y9aKzm.js";import"./RightOutlined-BjygEm6M.js";import"./index-CVwkEasZ.js";import"./Sider-Zob35Zsc.js";import"./collapse-BbEVqHco.js";import"./index-AnwF1dWy.js";import"./Pagination-DwGNua8v.js";import"./index-C9sF61Fr.js";const ue=()=>{const m=S(),[u,l]=o.useState(!1),[x,f]=o.useState([]),[s,h]=o.useState({current:1,pageSize:10,total:0}),[g,y]=o.useState(""),i=async(t=s.current,r=s.pageSize)=>{try{l(!0);const a=await d.getUsers({current:t,pageSize:r});a.success&&(f(a.data.list),h({...s,current:a.data.pagination.current,total:a.data.pagination.total||0}))}catch(a){console.error("获取用户列表失败:",a),c.error("获取用户列表失败")}finally{l(!1)}};o.useEffect(()=>{i()},[]);const j=t=>{i(t.current,t.pageSize)},p=()=>{i(1)},I=async t=>{try{(await d.deleteUser(t)).success&&(c.success("删除成功"),i())}catch(r){console.error("删除用户失败:",r),c.error("删除用户失败")}},R=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"用户名",dataIndex:"username",key:"username"},{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"角色",dataIndex:"role",key:"role",render:t=>e.jsx(P,{color:C(t),children:k(t)})},{title:"操作",key:"action",render:(t,r)=>e.jsxs(U,{size:"middle",children:[e.jsx(n,{type:"text",icon:e.jsx($,{}),onClick:()=>m(`/user/detail/${r.id}`),children:"查看"}),e.jsx(B,{title:"确定要删除此用户吗?",onConfirm:()=>I(r.id),okText:"确定",cancelText:"取消",children:e.jsx(n,{type:"text",danger:!0,icon:e.jsx(D,{}),children:"删除"})})]})}];return e.jsxs(T,{title:"用户列表",extra:e.jsx(n,{type:"primary",icon:e.jsx(w,{}),onClick:()=>m("/user/create"),children:"新建用户"}),children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(v,{placeholder:"搜索用户名或邮箱",value:g,onChange:t=>y(t.target.value),onPressEnter:p,style:{width:300,marginRight:8},prefix:e.jsx(z,{})}),e.jsx(n,{type:"primary",onClick:p,children:"搜索"})]}),e.jsx(E,{columns:R,rowKey:"id",dataSource:x,pagination:s,loading:u,onChange:j})]})};export{ue as default};
