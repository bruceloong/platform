import{u as S,r as o,j as e,B as n,T as d,L as c}from"./index-CbcJRL3k.js";import{g as k,a as C}from"./auth-D_zOBMeq.js";import{C as T,R as w}from"./index-yT7z0R9N.js";import{I as v}from"./index-C1q38Ntb.js";import{R as z}from"./SearchOutlined-CAodkCHB.js";import{F as E}from"./Table-C6DX0CPc.js";import{T as P}from"./index-DPIr4DBV.js";import{S as U}from"./index-CPCu-Awr.js";import{R as $}from"./EditOutlined-ZsrA_iia.js";import{P as B}from"./index-CSGmYRTD.js";import{R as D}from"./DeleteOutlined-D9_VD5Rq.js";import"./EllipsisOutlined-Dh0XXIS3.js";import"./roundedArrow-ZXwI2xFQ.js";import"./useVariants-DE2B2smb.js";import"./index-BqCjM9dL.js";import"./TextArea-BLJSUrB-.js";import"./styleChecker-wZ6_H3ZI.js";import"./index-CQWGyHIi.js";import"./PurePanel-3I4INXzI.js";import"./useIcons-DeF26C09.js";import"./DownOutlined-DkPoV1du.js";import"./index-w_CIewc6.js";import"./useBubbleLock-DGQtOuMD.js";import"./index-DO-dhtUz.js";import"./LeftOutlined-BtNA29Ex.js";import"./RightOutlined-BLpIbDbF.js";import"./index-BKzotca0.js";import"./Sider-DqSHZATv.js";import"./collapse-BbEVqHco.js";import"./index-BWjuplgR.js";import"./Pagination-1VEaDFmM.js";import"./index-CeTWp4GU.js";const ue=()=>{const m=S(),[u,l]=o.useState(!1),[x,f]=o.useState([]),[s,h]=o.useState({current:1,pageSize:10,total:0}),[g,y]=o.useState(""),i=async(t=s.current,r=s.pageSize)=>{try{l(!0);const a=await d.getUsers({current:t,pageSize:r});a.success&&(f(a.data.list),h({...s,current:a.data.pagination.current,total:a.data.pagination.total||0}))}catch(a){console.error("获取用户列表失败:",a),c.error("获取用户列表失败")}finally{l(!1)}};o.useEffect(()=>{i()},[]);const j=t=>{i(t.current,t.pageSize)},p=()=>{i(1)},I=async t=>{try{(await d.deleteUser(t)).success&&(c.success("删除成功"),i())}catch(r){console.error("删除用户失败:",r),c.error("删除用户失败")}},R=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"用户名",dataIndex:"username",key:"username"},{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"角色",dataIndex:"role",key:"role",render:t=>e.jsx(P,{color:C(t),children:k(t)})},{title:"操作",key:"action",render:(t,r)=>e.jsxs(U,{size:"middle",children:[e.jsx(n,{type:"text",icon:e.jsx($,{}),onClick:()=>m(`/user/detail/${r.id}`),children:"查看"}),e.jsx(B,{title:"确定要删除此用户吗?",onConfirm:()=>I(r.id),okText:"确定",cancelText:"取消",children:e.jsx(n,{type:"text",danger:!0,icon:e.jsx(D,{}),children:"删除"})})]})}];return e.jsxs(T,{title:"用户列表",extra:e.jsx(n,{type:"primary",icon:e.jsx(w,{}),onClick:()=>m("/user/create"),children:"新建用户"}),children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(v,{placeholder:"搜索用户名或邮箱",value:g,onChange:t=>y(t.target.value),onPressEnter:p,style:{width:300,marginRight:8},prefix:e.jsx(z,{})}),e.jsx(n,{type:"primary",onClick:p,children:"搜索"})]}),e.jsx(E,{columns:R,rowKey:"id",dataSource:x,pagination:s,loading:u,onChange:j})]})};export{ue as default};
