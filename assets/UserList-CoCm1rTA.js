import{u as S,r as o,j as e,B as n,T as d,L as c}from"./index-gwXPppyA.js";import{g as k,a as C}from"./auth-B_gkEfcF.js";import{C as T,R as w}from"./index-goZSXMNr.js";import{I as v}from"./index-D0F52OSf.js";import{R as z}from"./SearchOutlined-DdqiLUn6.js";import{F as E}from"./Table-C0HHJMM2.js";import{T as P}from"./index-DWY02ZNo.js";import{S as U}from"./index-RsA7oBgA.js";import{R as $}from"./EditOutlined-BOtlGvRH.js";import{P as B}from"./index-bHS231nS.js";import{R as D}from"./DeleteOutlined-yekKhJoo.js";import"./EllipsisOutlined-CBn_aQYb.js";import"./roundedArrow-UnQcrx47.js";import"./useVariants-D1uNV9L6.js";import"./index-BuOyQSrX.js";import"./TextArea-C9pSGXaW.js";import"./styleChecker-CEmuB9ey.js";import"./index--rYPTX4s.js";import"./PurePanel-CE15QNp1.js";import"./useIcons-BHuVDkqT.js";import"./DownOutlined-CQfZH5HP.js";import"./index-Di5SHUfI.js";import"./useBubbleLock-BdIDRmzE.js";import"./index-DZoHN5nl.js";import"./LeftOutlined-BXAS5QAf.js";import"./RightOutlined-DDgZv5AL.js";import"./index-KdSA8sJo.js";import"./Sider-Cb46hsRx.js";import"./collapse-BbEVqHco.js";import"./index-BXvtG7WC.js";import"./Pagination-3rX4dk2w.js";import"./index-DCa-OrwS.js";const ue=()=>{const m=S(),[u,l]=o.useState(!1),[x,f]=o.useState([]),[s,h]=o.useState({current:1,pageSize:10,total:0}),[g,y]=o.useState(""),i=async(t=s.current,r=s.pageSize)=>{try{l(!0);const a=await d.getUsers({current:t,pageSize:r});a.success&&(f(a.data.list),h({...s,current:a.data.pagination.current,total:a.data.pagination.total||0}))}catch(a){console.error("获取用户列表失败:",a),c.error("获取用户列表失败")}finally{l(!1)}};o.useEffect(()=>{i()},[]);const j=t=>{i(t.current,t.pageSize)},p=()=>{i(1)},I=async t=>{try{(await d.deleteUser(t)).success&&(c.success("删除成功"),i())}catch(r){console.error("删除用户失败:",r),c.error("删除用户失败")}},R=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"用户名",dataIndex:"username",key:"username"},{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"角色",dataIndex:"role",key:"role",render:t=>e.jsx(P,{color:C(t),children:k(t)})},{title:"操作",key:"action",render:(t,r)=>e.jsxs(U,{size:"middle",children:[e.jsx(n,{type:"text",icon:e.jsx($,{}),onClick:()=>m(`/user/detail/${r.id}`),children:"查看"}),e.jsx(B,{title:"确定要删除此用户吗?",onConfirm:()=>I(r.id),okText:"确定",cancelText:"取消",children:e.jsx(n,{type:"text",danger:!0,icon:e.jsx(D,{}),children:"删除"})})]})}];return e.jsxs(T,{title:"用户列表",extra:e.jsx(n,{type:"primary",icon:e.jsx(w,{}),onClick:()=>m("/user/create"),children:"新建用户"}),children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(v,{placeholder:"搜索用户名或邮箱",value:g,onChange:t=>y(t.target.value),onPressEnter:p,style:{width:300,marginRight:8},prefix:e.jsx(z,{})}),e.jsx(n,{type:"primary",onClick:p,children:"搜索"})]}),e.jsx(E,{columns:R,rowKey:"id",dataSource:x,pagination:s,loading:u,onChange:j})]})};export{ue as default};
