import{u as S,r as o,j as e,B as n,T as d,L as c}from"./index-CVvmjeEA.js";import{g as k,a as C}from"./auth-D18o0tP3.js";import{C as T,R as w}from"./index-B0oa_COk.js";import{I as v}from"./index-BHSxPz8q.js";import{R as z}from"./SearchOutlined-Dm1npqh1.js";import{F as E}from"./Table-BDdq_jgn.js";import{T as P}from"./index-D6fMBZ1s.js";import{S as U}from"./index-ClqAjj3M.js";import{R as $}from"./EditOutlined-CRv0jD4x.js";import{P as B}from"./index-CF8-Qrkk.js";import{R as D}from"./DeleteOutlined-CIn2YWnz.js";import"./EllipsisOutlined-s8YjcG2E.js";import"./roundedArrow-Sv4qF1M1.js";import"./useVariants-DBDSD-SJ.js";import"./index-DppUYI3Q.js";import"./TextArea-C-1E40xJ.js";import"./styleChecker-C4ah6wGg.js";import"./index-WrFtDlwX.js";import"./PurePanel-CKU-CKfA.js";import"./useIcons-DBPDwa0t.js";import"./DownOutlined-C010dmO0.js";import"./index-C8bU8yRg.js";import"./useBubbleLock-DAqvF0N4.js";import"./index-5aDbwc7A.js";import"./LeftOutlined-OLsymj45.js";import"./RightOutlined-BrREPCSM.js";import"./index-DVfvNWzl.js";import"./Sider-Wc_MSAUN.js";import"./collapse-BbEVqHco.js";import"./index-DW3YOSYr.js";import"./Pagination-9EqZDy_N.js";import"./index-hgLlXZN8.js";const ue=()=>{const m=S(),[u,l]=o.useState(!1),[x,f]=o.useState([]),[s,h]=o.useState({current:1,pageSize:10,total:0}),[g,y]=o.useState(""),i=async(t=s.current,r=s.pageSize)=>{try{l(!0);const a=await d.getUsers({current:t,pageSize:r});a.success&&(f(a.data.list),h({...s,current:a.data.pagination.current,total:a.data.pagination.total||0}))}catch(a){console.error("获取用户列表失败:",a),c.error("获取用户列表失败")}finally{l(!1)}};o.useEffect(()=>{i()},[]);const j=t=>{i(t.current,t.pageSize)},p=()=>{i(1)},I=async t=>{try{(await d.deleteUser(t)).success&&(c.success("删除成功"),i())}catch(r){console.error("删除用户失败:",r),c.error("删除用户失败")}},R=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"用户名",dataIndex:"username",key:"username"},{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"角色",dataIndex:"role",key:"role",render:t=>e.jsx(P,{color:C(t),children:k(t)})},{title:"操作",key:"action",render:(t,r)=>e.jsxs(U,{size:"middle",children:[e.jsx(n,{type:"text",icon:e.jsx($,{}),onClick:()=>m(`/user/detail/${r.id}`),children:"查看"}),e.jsx(B,{title:"确定要删除此用户吗?",onConfirm:()=>I(r.id),okText:"确定",cancelText:"取消",children:e.jsx(n,{type:"text",danger:!0,icon:e.jsx(D,{}),children:"删除"})})]})}];return e.jsxs(T,{title:"用户列表",extra:e.jsx(n,{type:"primary",icon:e.jsx(w,{}),onClick:()=>m("/user/create"),children:"新建用户"}),children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(v,{placeholder:"搜索用户名或邮箱",value:g,onChange:t=>y(t.target.value),onPressEnter:p,style:{width:300,marginRight:8},prefix:e.jsx(z,{})}),e.jsx(n,{type:"primary",onClick:p,children:"搜索"})]}),e.jsx(E,{columns:R,rowKey:"id",dataSource:x,pagination:s,loading:u,onChange:j})]})};export{ue as default};
