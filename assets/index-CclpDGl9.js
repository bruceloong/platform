import{r as t,l as te,m as oe,n as re,M as ne,aO as se,C as W,V as ae,aw as X,h as G,e as ie,s as le}from"./index-CVvmjeEA.js";import{a as ce,r as de,R as ge}from"./roundedArrow-Sv4qF1M1.js";import{a as ue}from"./index-hgLlXZN8.js";const V=t.createContext({}),me=e=>{const{antCls:n,componentCls:s,iconCls:o,avatarBg:a,avatarColor:z,containerSize:S,containerSizeLG:h,containerSizeSM:v,textFontSize:m,textFontSizeLG:C,textFontSizeSM:R,borderRadius:p,borderRadiusLG:g,borderRadiusSM:O,lineWidth:N,lineType:w}=e,E=(r,u,$)=>({width:r,height:r,borderRadius:"50%",[`&${s}-square`]:{borderRadius:$},[`&${s}-icon`]:{fontSize:u,[`> ${o}`]:{margin:0}}});return{[s]:Object.assign(Object.assign(Object.assign(Object.assign({},re(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:z,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:a,border:`${ne(N)} ${w} transparent`,"&-image":{background:"transparent"},[`${n}-image-img`]:{display:"block"}}),E(S,m,p)),{"&-lg":Object.assign({},E(h,C,g)),"&-sm":Object.assign({},E(v,R,O)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},pe=e=>{const{componentCls:n,groupBorderColor:s,groupOverlapping:o,groupSpace:a}=e;return{[`${n}-group`]:{display:"inline-flex",[n]:{borderColor:s},"> *:not(:first-child)":{marginInlineStart:o}},[`${n}-group-popover`]:{[`${n} + ${n}`]:{marginInlineStart:a}}}},ve=e=>{const{controlHeight:n,controlHeightLG:s,controlHeightSM:o,fontSize:a,fontSizeLG:z,fontSizeXL:S,fontSizeHeading3:h,marginXS:v,marginXXS:m,colorBorderBg:C}=e;return{containerSize:n,containerSizeLG:s,containerSizeSM:o,textFontSize:Math.round((z+S)/2),textFontSizeLG:h,textFontSizeSM:a,groupSpace:m,groupOverlapping:-v,groupBorderColor:C}},q=te("Avatar",e=>{const{colorTextLightSolid:n,colorTextPlaceholder:s}=e,o=oe(e,{avatarBg:s,avatarColor:n});return[me(o),pe(o)]},ve);var fe=function(e,n){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)n.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};const Se=(e,n)=>{const[s,o]=t.useState(1),[a,z]=t.useState(!1),[S,h]=t.useState(!0),v=t.useRef(null),m=t.useRef(null),C=se(n,v),{getPrefixCls:R,avatar:p}=t.useContext(W),g=t.useContext(V),O=()=>{if(!m.current||!v.current)return;const i=m.current.offsetWidth,l=v.current.offsetWidth;if(i!==0&&l!==0){const{gap:f=4}=e;f*2<l&&o(l-f*2<i?(l-f*2)/i:1)}};t.useEffect(()=>{z(!0)},[]),t.useEffect(()=>{h(!0),o(1)},[e.src]),t.useEffect(O,[e.gap]);const N=()=>{const{onError:i}=e;(i==null?void 0:i())!==!1&&h(!1)},{prefixCls:w,shape:E,size:r,src:u,srcSet:$,icon:x,className:A,rootClassName:L,alt:B,draggable:I,children:y,crossOrigin:j}=e,b=fe(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),c=ae(i=>{var l,f;return(f=(l=r??(g==null?void 0:g.size))!==null&&l!==void 0?l:i)!==null&&f!==void 0?f:"default"}),k=Object.keys(typeof c=="object"?c||{}:{}).some(i=>["xs","sm","md","lg","xl","xxl"].includes(i)),M=ce(k),F=t.useMemo(()=>{if(typeof c!="object")return{};const i=de.find(f=>M[f]),l=c[i];return l?{width:l,height:l,fontSize:l&&(x||y)?l/2:18}:{}},[M,c]),d=R("avatar",w),T=X(d),[J,K,Q]=q(d,T),U=G({[`${d}-lg`]:c==="large",[`${d}-sm`]:c==="small"}),_=t.isValidElement(u),Y=E||(g==null?void 0:g.shape)||"circle",Z=G(d,U,p==null?void 0:p.className,`${d}-${Y}`,{[`${d}-image`]:_||u&&S,[`${d}-icon`]:!!x},Q,T,A,L,K),ee=typeof c=="number"?{width:c,height:c,fontSize:x?c/2:18}:{};let P;if(typeof u=="string"&&S)P=t.createElement("img",{src:u,draggable:I,srcSet:$,onError:N,alt:B,crossOrigin:j});else if(_)P=u;else if(x)P=x;else if(a||s!==1){const i=`scale(${s})`,l={msTransform:i,WebkitTransform:i,transform:i};P=t.createElement(ge,{onResize:O},t.createElement("span",{className:`${d}-string`,ref:m,style:Object.assign({},l)},y))}else P=t.createElement("span",{className:`${d}-string`,style:{opacity:0},ref:m},y);return delete b.onError,delete b.gap,J(t.createElement("span",Object.assign({},b,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),F),p==null?void 0:p.style),b.style),className:Z,ref:C}),P))},D=t.forwardRef(Se),H=e=>{const{size:n,shape:s}=t.useContext(V),o=t.useMemo(()=>({size:e.size||n,shape:e.shape||s}),[e.size,e.shape,n,s]);return t.createElement(V.Provider,{value:o},e.children)},he=e=>{var n,s,o,a;const{getPrefixCls:z,direction:S}=t.useContext(W),{prefixCls:h,className:v,rootClassName:m,style:C,maxCount:R,maxStyle:p,size:g,shape:O,maxPopoverPlacement:N,maxPopoverTrigger:w,children:E,max:r}=e,u=z("avatar",h),$=`${u}-group`,x=X(u),[A,L,B]=q(u,x),I=G($,{[`${$}-rtl`]:S==="rtl"},B,x,v,m,L),y=ie(E).map((c,k)=>le(c,{key:`avatar-key-${k}`})),j=(r==null?void 0:r.count)||R,b=y.length;if(j&&j<b){const c=y.slice(0,j),k=y.slice(j,b),M=(r==null?void 0:r.style)||p,F=((n=r==null?void 0:r.popover)===null||n===void 0?void 0:n.trigger)||w||"hover",d=((s=r==null?void 0:r.popover)===null||s===void 0?void 0:s.placement)||N||"top",T=Object.assign(Object.assign({content:k},r==null?void 0:r.popover),{classNames:{root:G(`${$}-popover`,(a=(o=r==null?void 0:r.popover)===null||o===void 0?void 0:o.classNames)===null||a===void 0?void 0:a.root)},placement:d,trigger:F});return c.push(t.createElement(ue,Object.assign({key:"avatar-popover-key",destroyTooltipOnHide:!0},T),t.createElement(D,{style:M},`+${b-j}`))),A(t.createElement(H,{shape:O,size:g},t.createElement("div",{className:I,style:C},c)))}return A(t.createElement(H,{shape:O,size:g},t.createElement("div",{className:I,style:C},y)))},Ce=D;Ce.Group=he;export{Ce as A};
